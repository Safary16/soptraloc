# Render.com - Deploy optimizado para SafaryLocservices:

services:  - type: web

  - type: web    name: soptraloc-web

    name: safary-soptraloc    env: python

    env: python    buildCommand: "pip install -r requirements.txt"

    repo: https://github.com/Safary16/soptraloc.git    startCommand: "cd soptraloc_system && python manage.py migrate && python manage.py collectstatic --noinput && gunicorn config.wsgi:application"

    rootDir: soptraloc_system    plan: free

    buildCommand: |    envVars:

      pip install -r ../requirements.txt      - key: PYTHON_VERSION

      python manage.py collectstatic --noinput --settings=config.settings_production        value: 3.12.3

    startCommand: |      - key: DEBUG

      python manage.py migrate --settings=config.settings_production        value: False

      python manage.py shell --settings=config.settings_production -c "      - key: SECRET_KEY

      from django.contrib.auth.models import User        generateValue: true

      if not User.objects.filter(username='admin').exists():      - key: DATABASE_URL

          User.objects.create_superuser('admin', 'admin@safary.com', 'admin123')        fromDatabase:

          print('âœ… Superusuario creado: admin/admin123')          name: soptraloc-db

      "          property: connectionString

      gunicorn --bind=0.0.0.0:$PORT --timeout 600 config.wsgi:application      - key: REDIS_URL

    plan: free        fromService:

    envVars:          type: redis

      - key: PYTHON_VERSION          name: soptraloc-redis

        value: 3.11          property: connectionString

      - key: DEBUG

        value: False  - type: redis

      - key: DJANGO_SETTINGS_MODULE    name: soptraloc-redis

        value: config.settings_production    plan: free

      - key: SECRET_KEY    ipAllowList: []

        generateValue: true

      - key: DATABASE_URL  - type: worker

        fromDatabase:    name: soptraloc-celery

          name: safary-postgres    env: python

          property: connectionString    buildCommand: "pip install -r requirements.txt"

    startCommand: "cd soptraloc_system && celery -A config worker -l info"

databases:    plan: free

  - name: safary-postgres    envVars:

    databaseName: safarylocdb      - key: PYTHON_VERSION

    user: safary        value: 3.12.3

    plan: free      - key: DATABASE_URL
        fromDatabase:
          name: soptraloc-db
          property: connectionString
      - key: REDIS_URL
        fromService:
          type: redis
          name: soptraloc-redis
          property: connectionString

databases:
  - name: soptraloc-db
    plan: free