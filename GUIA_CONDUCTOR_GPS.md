# 📱 Guía del Conductor - GPS Background Tracking

## 🎯 ¿Por Qué Cambió el Sistema?

### Problema Anterior ❌
- Necesitabas tener el celular **desbloqueado**
- La app tenía que estar **abierta en primer plano**
- Si bloqueabas la pantalla, el GPS dejaba de funcionar
- **Esto es ILEGAL** según la Ley de Tránsito

### Nueva Solución ✅
- ✅ Puedes **bloquear el celular**
- ✅ Puedes **cerrar la app**
- ✅ El GPS sigue funcionando en segundo plano
- ✅ **100% legal y seguro**

---

## 📲 Instalación de la App (Una Sola Vez)

### Para Android (Chrome):

**Paso 1**: Abrir el enlace que te envió tu supervisor
```
https://soptraloc.onrender.com/driver/login/
```

**Paso 2**: Chrome mostrará un banner en la parte inferior:
```
┌─────────────────────────────────────┐
│ Agregar SoptraLoc a pantalla inicio │
│                                     │
│  [Cancelar]          [Instalar]    │
└─────────────────────────────────────┘
```

**Paso 3**: Tocar **"Instalar"**

**Paso 4**: ✅ La app aparecerá en tu pantalla de inicio como cualquier app

### Para iPhone (Safari):

**Paso 1**: Abrir el enlace en Safari
```
https://soptraloc.onrender.com/driver/login/
```

**Paso 2**: Tocar el botón **Compartir** (el cuadrado con flecha hacia arriba)

**Paso 3**: Bajar y seleccionar **"Agregar a pantalla de inicio"**

**Paso 4**: ✅ La app aparecerá en tu pantalla de inicio

---

## 🔐 Primera Vez Usando la App

### 1. Iniciar Sesión

Abrir la app e ingresar tus datos:
```
Usuario: tu_nombre (ejemplo: juan_perez)
Contraseña: la que te dieron
```

### 2. Aceptar Permisos de Ubicación

La app te pedirá permiso para usar tu ubicación:

```
┌─────────────────────────────────────┐
│ SoptraLoc quiere acceder            │
│ a tu ubicación                      │
│                                     │
│ [Solo mientras uso la app]          │
│ [Siempre] ← SELECCIONA ESTA         │
│ [No permitir]                       │
└─────────────────────────────────────┘
```

⚠️ **IMPORTANTE**: Seleccionar **"Siempre"** o **"Permitir todo el tiempo"**

Esto permite que el GPS funcione en segundo plano.

### 3. Aceptar Notificaciones (Opcional pero Recomendado)

```
┌─────────────────────────────────────┐
│ SoptraLoc quiere enviarte           │
│ notificaciones                      │
│                                     │
│ [No permitir]  [Permitir]           │
└─────────────────────────────────────┘
```

Las notificaciones te avisarán cuando:
- Te asignen un nuevo contenedor
- Haya cambios en tus entregas
- Mensajes importantes del supervisor

---

## 🚛 Uso Diario

### Al Iniciar Turno:

**Paso 1**: Abrir la app SoptraLoc

**Paso 2**: Esperar que aparezca:
```
GPS: Activo ±10m
```

**Paso 3**: ✅ Listo, ya puedes cerrar la app o bloquear el celular

### Durante la Ruta:

✅ **Puedes hacer TODO esto y el GPS sigue funcionando:**

- ✅ Bloquear la pantalla
- ✅ Cerrar la app
- ✅ Usar otras apps (WhatsApp, Google Maps, etc.)
- ✅ Recibir llamadas
- ✅ Guardar el celular en el portavasos

⚠️ **NO hacer:**
- ❌ Desinstalar la app
- ❌ Forzar cierre de la app desde Ajustes
- ❌ Desactivar ubicación del celular
- ❌ Poner el celular en modo avión

### Al Llegar a Destino:

**Opción 1**: La app te notificará automáticamente

**Opción 2**: Abrir la app para ver detalles de la entrega

---

## 🔔 Notificaciones

### Tipos de Notificaciones:

**1. Nueva Entrega Asignada**
```
┌─────────────────────────────────┐
│ 🚛 SoptraLoc                    │
│                                 │
│ Nueva entrega asignada          │
│ TCLU1234567 → CD Puente Alto    │
│                                 │
│ [Ver Detalles] [Cerrar]         │
└─────────────────────────────────┘
```

**2. Cambio en Programación**
```
┌─────────────────────────────────┐
│ ⚠️  SoptraLoc                    │
│                                 │
│ Cambio de horario               │
│ Nueva hora: 14:00               │
│                                 │
│ [Ver Detalles] [Cerrar]         │
└─────────────────────────────────┘
```

**3. GPS Desconectado**
```
┌─────────────────────────────────┐
│ ⚠️  SoptraLoc                    │
│                                 │
│ GPS desconectado                │
│ Por favor, revisa tus permisos  │
│                                 │
│ [Revisar] [Cerrar]              │
└─────────────────────────────────┘
```

---

## 🔧 Solución de Problemas

### Problema 1: GPS No Funciona

**Síntoma**: La app muestra "GPS desactivado"

**Solución**:
1. Ir a **Ajustes** del celular
2. Buscar **Ubicación**
3. Verificar que esté **Activada**
4. Buscar **SoptraLoc** en la lista de apps
5. Cambiar permiso a **"Permitir todo el tiempo"**

**En Android:**
```
Ajustes → Ubicación → Permisos de apps → SoptraLoc
→ Permitir todo el tiempo
```

**En iPhone:**
```
Ajustes → Privacidad → Ubicación → SoptraLoc
→ Siempre
```

### Problema 2: No Recibo Notificaciones

**Solución**:
1. Ir a **Ajustes**
2. Buscar **Notificaciones**
3. Buscar **SoptraLoc**
4. Activar **"Permitir notificaciones"**

### Problema 3: La App Se Cerró Sola

**Solución**:
1. Verificar que no esté en "Modo ahorro de batería extremo"
2. Agregar SoptraLoc a "Apps protegidas" (solo Android):
   ```
   Ajustes → Batería → Optimización de batería
   → Buscar SoptraLoc → No optimizar
   ```

### Problema 4: El Supervisor No Ve Mi Ubicación

**Solución**:
1. Verificar que tengas internet (WiFi o datos móviles)
2. Abrir la app y verificar que diga "GPS: Activo"
3. Si dice "GPS desactivado", seguir solución del Problema 1
4. Si persiste, contactar a tu supervisor

---

## 📞 Contacto y Soporte

### ¿Necesitas Ayuda?

**Contactar a:**
- Supervisor directo
- Área de Logística: +56 9 XXXX XXXX
- Email: soporte@soptraloc.cl

**Información a Proporcionar:**
- Tu nombre completo
- Modelo de celular (ej: Samsung Galaxy A52)
- Descripción del problema
- Captura de pantalla (si es posible)

---

## ✅ Checklist Diario

Al iniciar turno, verificar:

- [ ] App instalada en pantalla de inicio
- [ ] GPS activo (muestra "GPS: Activo")
- [ ] Notificaciones permitidas
- [ ] Ubicación permitida "todo el tiempo"
- [ ] Celular con batería suficiente (>20%)
- [ ] Internet activo (WiFi o datos móviles)

Si todo está ✅, ¡estás listo para trabajar!

---

## 🔋 Consejos para Ahorrar Batería

La app está optimizada para consumir **poca batería**, pero estos consejos ayudan:

1. **Mantener brillo de pantalla bajo** cuando uses el celular
2. **Cerrar apps que no uses** (WhatsApp en segundo plano, etc.)
3. **Usar WiFi cuando esté disponible** (consume menos que datos)
4. **No usar "alta precisión"** de GPS (la app usa precisión estándar)
5. **Llevar cargador de auto** por si acaso

**Consumo Estimado de Batería:**
- Con pantalla bloqueada: **~5-7% por hora**
- Con pantalla prendida: **~15-20% por hora**

---

## 🎓 Preguntas Frecuentes

**P: ¿Puedo usar otras apps mientras trabajo?**  
R: ✅ Sí, SoptraLoc funciona en segundo plano. Puedes usar WhatsApp, Google Maps, etc.

**P: ¿El GPS funciona sin internet?**  
R: El GPS funciona, pero necesita internet para enviar la ubicación al servidor. Si pierdes internet, la app guarda las ubicaciones y las envía cuando vuelvas a tener conexión.

**P: ¿Puedo desactivar el GPS cuando termine mi turno?**  
R: ✅ Sí, puedes cerrar sesión en la app o desactivar la ubicación del celular.

**P: ¿La empresa puede ver mi ubicación fuera del horario laboral?**  
R: ❌ No. El sistema solo registra ubicación cuando tienes una entrega asignada y estás en horario laboral.

**P: ¿Qué pasa si mi celular se queda sin batería?**  
R: La app deja de enviar ubicación, pero cuando lo cargues y enciendas, se reconectará automáticamente.

**P: ¿Puedo tener la app en varios celulares?**  
R: ✅ Sí, pero solo debes usar un celular a la vez para tracking.

---

## 📝 Términos de Uso del GPS

Al usar la app aceptas que:

✅ Tu ubicación se registra **solo durante horas laborales**  
✅ Los datos se usan **exclusivamente para logística**  
✅ Puedes **desactivar el GPS en cualquier momento**  
✅ Tus datos están **protegidos** según Ley 19.628

❌ Los datos NO se usan para:
- Monitoreo personal fuera del trabajo
- Venta a terceros
- Fines no relacionados con entregas

---

**Última actualización**: 2025-10-14  
**Versión de la app**: 1.0.0 (PWA)  
**Sistema**: SoptraLoc TMS

---

**¿Dudas? Contacta a tu supervisor o al área de soporte técnico.**

✅ **¡Gracias por usar SoptraLoc!**
